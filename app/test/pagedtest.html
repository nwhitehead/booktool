<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Test of PagedJS</title>
        <style>
            p {
                hyphens: manual;
                text-align: justify;
            }
            @page {
                size: 120mm 150mm;
                bleed: 6mm;
                marks: crop;
            }

        </style>
    </head>
    <body>
        <h1>Margin boxes of a page</h1>

        <p>A certain king had a beautiful garden.</p>

        <p>A page box consists of two types of area: page area and page mar&shy;gin
        boxes.</p>
        
        <p>The page area is the content area of a page box. It is the space into
        which all your HTML content will flow. When this content runs out of
        room, another page will be automatically created. It's what the chunker
        part of Paged.js do.</p>
        
        <p>The margins of a page are divided into sixteen boxes where you can
        put generated content like page number and running heads. These boxes
        are called margin boxes.</p>
        
        <p>Each have its own margin, border, padding, and content areas. By
        default, their sizes are determined by the margin of the page box.</p>
        
        <p>The figure bellow represent the sixteen margin boxes of a page
        defined by the W3C:</p>

        <p>This is final body text.</p>
    </body>
    <script>
        globalThis.PagedConfig = {
            auto: false,
        };
    </script>
    <script src="https://unpkg.com/pagedjs/dist/paged.polyfill.js"></script>
    <script src="https://unpkg.com/tex-linebreak2@0.8.4/dist/lib.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hyphen@1.10.6/patterns/en-us.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hyphen@1.10.6/hyphen.min.js"></script>
<script>
    function addHyphens() {
        const hyphenate = createHyphenator(hyphenationPatternsEnUs);
        const elems = document.querySelectorAll('p');
        for (const elem of elems) {
            elem.innerHTML = hyphenate(elem.innerHTML);
        }
    }

    function linebreak() {
        const { texLinebreakDOM } = globalThis.texLinebreak;
        texLinebreakDOM('p', { justify: true });
    }

    function paginate() {
        globalThis.PagedPolyfill.preview();
    }

    function register() {
        class MyHandler extends Paged.Handler {
            constructor(chunker, polisher, caller) {
                super(chunker, polisher, caller);
            }

            beforePageLayout(page) {
                console.log('beforePageLayout', page);
                const { texLinebreakDOM } = globalThis.texLinebreak;
                texLinebreakDOM('p', { justify: true, stripSoftHyphensFromOutputText: false });
            }
        }
        Paged.registerHandlers(MyHandler);
    }
</script>
    <button onclick="addHyphens()">Add hyphens</button>
    <button onclick="linebreak()">TeX linebreak</button>
    <button onclick="register()">Register handler</button>
    <button onclick="paginate()">Paginate</button>
</html>
